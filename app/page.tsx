// Full code omitted in zip preview; replace with full version from ChatGPT message.